<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="VisioAnalytica.App.Risk.Pages.ResultsPage"
             Title="Resultados del An치lisis">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="15">
            
            <!-- Image Preview -->
            <Border 
                Stroke="Gray"
                StrokeThickness="2"
                StrokeShape="RoundRectangle 10"
                HeightRequest="250"
                Margin="0,0,0,20">
                <Image 
                    x:Name="AnalysisImage"
                    Aspect="AspectFit" />
            </Border>

            <!-- Results Header -->
            <Label 
                Text="Hallazgos Identificados"
                FontSize="20"
                FontAttributes="Bold"
                Margin="0,10,0,10" />

            <!-- Findings List -->
            <CollectionView 
                x:Name="FindingsCollection"
                ItemsSource="{Binding Findings}">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Border 
                            Stroke="{Binding RiskColor}"
                            StrokeThickness="2"
                            StrokeShape="RoundRectangle 10"
                            Padding="15"
                            Margin="0,0,0,10">
                            <VerticalStackLayout Spacing="10">
                                <!-- Risk Level Badge -->
                                <Label 
                                    Text="{Binding NivelRiesgo}"
                                    FontSize="16"
                                    FontAttributes="Bold"
                                    TextColor="{Binding RiskColor}"
                                    BackgroundColor="{Binding RiskBackgroundColor}"
                                    Padding="10,5"
                                    HorizontalOptions="Start" />

                                <!-- Description -->
                                <Label 
                                    Text="{Binding Descripcion}"
                                    FontSize="14"
                                    FontAttributes="Bold" />

                                <!-- Corrective Action -->
                                <Label 
                                    Text="Acci칩n Correctiva:"
                                    FontSize="12"
                                    FontAttributes="Bold"
                                    TextColor="Gray" />
                                <Label 
                                    Text="{Binding AccionCorrectiva}"
                                    FontSize="13" />

                                <!-- Preventive Action -->
                                <Label 
                                    Text="Acci칩n Preventiva:"
                                    FontSize="12"
                                    FontAttributes="Bold"
                                    TextColor="Gray"
                                    Margin="0,5,0,0" />
                                <Label 
                                    Text="{Binding AccionPreventiva}"
                                    FontSize="13" />
                            </VerticalStackLayout>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <!-- No Findings Message -->
            <Label 
                x:Name="NoFindingsLabel"
                Text="No se encontraron riesgos en esta imagen."
                FontSize="16"
                TextColor="Green"
                HorizontalOptions="Center"
                Margin="0,20,0,0"
                IsVisible="False" />

            <!-- Action Buttons -->
            <Button 
                x:Name="NewAnalysisButton"
                Text="Nuevo An치lisis"
                Clicked="OnNewAnalysisClicked"
                BackgroundColor="#512BD4"
                TextColor="White"
                CornerRadius="10"
                HeightRequest="50"
                Margin="0,20,0,10" />

            <Button 
                x:Name="HistoryButton"
                Text="Ver Historial"
                Clicked="OnHistoryClicked"
                BackgroundColor="Transparent"
                TextColor="#512BD4"
                HeightRequest="50" />

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>

